# 📋 待办事项清单

> **最后更新**: 2026-01-18 15:45

---

## 🔴 P1 - 重要待办

### 1. 语音功能测试

- **描述**: ASR/TTS端到端测试
- **要求**: 需要麦克风设备
- **预估**: 2小时
- **状态**: ⏳ 待完成

---

## 🟡 P2 - 计划中

### 2. 用户管理（轻量版）⭐ NEW

- **描述**: 商户后台查看用户列表和对话历史
- **方案**: 直接从Context Pool捞数据，不绕弯
- **功能**:
  - 用户列表（从Redis获取所有会话key）
  - 对话历史（点击用户查看对话记录）
  - 基础信息（访问时间、对话数）
- **预估**: 1-2天
- **状态**: ⏳ 待开发

### 3. 用户认证增强

- **描述**: 更安全的登录机制
- **预估**: 3小时
- **状态**: ⏳ 待完成

### 4. 性能图表

- **描述**: 监控面板添加趋势图
- **预估**: 2小时
- **状态**: ⏳ 待完成

---

## 🟢 P3 - 可选

### 5. 告警功能

- **描述**: 系统异常时通知
- **预估**: 1小时
- **状态**: ⏳ 待完成

### 6. 多语言支持

- **描述**: 英语/日语等
- **预估**: 3天
- **状态**: ⏳ 待完成

---

## ✅ 已完成

| 功能                    | 完成时间   |
| ----------------------- | ---------- |
| 热门问题缓存优化        | 2026-01-16 |
| 配置管理完善            | 2026-01-16 |
| 监控面板增强            | 2026-01-16 |
| 批量导入导出            | 2026-01-17 |
| 知识库AI整理            | 2026-01-17 |
| Bug修复（知识库保存）   | 2026-01-18 |
| Bug修复（报缺重复计数） | 2026-01-18 |

---

## 📝 用户管理功能设计（轻量版）

### 数据来源

直接从Context Pool (Redis) 获取：

- `context:{merchantId}:{userId}:{sessionId}` - 对话记录
- 不需要额外的用户表

### 界面设计

**用户列表页**

```
+------------------------------------------+
| 👥 用户管理              商户: dongli    |
+------------------------------------------+
| 用户ID      | 会话数 | 最近活跃 | 操作   |
|-------------|--------|----------|--------|
| user_abc123 | 3      | 今天     | [查看] |
| user_def456 | 1      | 昨天     | [查看] |
+------------------------------------------+
```

**对话详情**

```
+------------------------------------------+
| 💬 用户对话: user_abc123                 |
+------------------------------------------+
| 会话: session_xxx                        |
| 时间: 2026-01-18 10:23                   |
+------------------------------------------+
| 👤 用户: 门票多少钱？                     |
| 🤖 AI: 成人60元，学生票30元...            |
| 👤 用户: 怎么去？                         |
| 🤖 AI: 可以乘坐361路公交...               |
+------------------------------------------+
```

### 实现步骤

1. 添加后端API：`/api/merchant/:id/users`
2. 从Redis扫描keys获取用户列表
3. 前端创建UserManagementPage
4. 集成到后台导航

### 技术要点

- 使用Redis SCAN命令获取keys（避免阻塞）
- 解析key获取merchantId/userId/sessionId
- 调用contextPool.getHistory()获取对话历史

---

**更新时间**: 2026-01-18 15:45
